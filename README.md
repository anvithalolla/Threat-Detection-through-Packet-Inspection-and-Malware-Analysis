# Threat Detection through Packet Inspection and Malware Analysis
## Description

This case study documents the forensic investigation of a targeted spear phishing attack against SaucyCorp's lead developer, Vick Timmes. The objective was to identify the source of compromise and recover malware from the network traffic for further analysis.

## Table of Contents

- [Introduction](#introduction)
- [Evidence](#evidence)
- [Analysis](#analysis)
- [Theory of the Case](#theory-of-the-case)
- [Findings](#findings)

## Introduction

The analysis unfolds the events leading to a security breach within SaucyCorp, revealing the modus operandi of the attacker and the vulnerabilities exploited during the attack. This document serves as a detailed record for forensic investigators and cybersecurity professionals.

## Evidence

Provided with a packet capture file named `evidence-malware.pcap`, the task was to inspect and analyze the network traffic to identify malicious activities and recover any malware present.

## Analysis

### Intrusion Detection

The initial step involved processing the packet capture through Snort IDS, revealing alerts for potential malware transmission.
![image](https://github.com/anvithalolla/Threat-Detection-through-Packet-Inspection-and-Malware-Analysis/assets/55392153/ec35b30b-a2f2-4c8f-b2f5-17dd0c06ea38)

![image](https://github.com/anvithalolla/Threat-Detection-through-Packet-Inspection-and-Malware-Analysis/assets/55392153/307fd4e3-6a82-4b61-84b7-b176b4830add)

### TCP Conversation: 10.10.10.10:4444–10.10.10.70:1036

The TCP stream indicated the transfer of a Windows executable from the external host to Vick Timmes's internal computer, which triggered a Snort alert for malware.
![image](https://github.com/anvithalolla/Threat-Detection-through-Packet-Inspection-and-Malware-Analysis/assets/55392153/c70ab268-c408-46ee-af21-363b30212d4c)

### File Carving: 10.10.10.10:4444–10.10.10.70:1036

Using file carving tools, we extracted a suspicious Windows executable from the stream for further analysis.

![image](https://github.com/anvithalolla/Threat-Detection-through-Packet-Inspection-and-Malware-Analysis/assets/55392153/67ef97d9-3798-4a48-a871-f720ac93be28)

### Threat Expert Report

Upon analysis, a ThreatExpert report classified the executable as a potential trojan or bot, indicating a security risk.

![image](https://github.com/anvithalolla/Threat-Detection-through-Packet-Inspection-and-Malware-Analysis/assets/55392153/3ac605ec-e49a-4829-9bc9-6a90f6672cb6)

### Traffic Analysis: 10.10.10.10:4444–10.10.10.70:1036

In-depth analysis of the TCP stream was conducted to understand the functionality of the transmitted executable.

### TCP Conversations: 10.10.10.10:4445

Multiple connection attempts to this port were noted, indicating possible command-and-control communication attempts.

### Traffic Analysis: 10.10.10.10:4445

Further analysis of traffic to this port revealed unusual TCP reset packets, suggesting atypical network behavior.

### File Carving: 10.10.10.10:4445

The same Windows executable file was sent again during this TCP conversation, confirming repeated malicious activities.
 
![image](https://github.com/anvithalolla/Threat-Detection-through-Packet-Inspection-and-Malware-Analysis/assets/55392153/bdab8969-92fc-46cd-b3b5-8d9c206ad27c)

![image](https://github.com/anvithalolla/Threat-Detection-through-Packet-Inspection-and-Malware-Analysis/assets/55392153/5388e755-3d23-46a3-9e14-fabd17a01dc0)


### TCP Conversation: 10.10.10.10:8080–10.10.10.70:1035

Investigation of the initial HTTP traffic between the two hosts revealed the first point of contact that led to the compromise.


![image](https://github.com/anvithalolla/Threat-Detection-through-Packet-Inspection-and-Malware-Analysis/assets/55392153/b0c7bf49-2845-4876-9243-66e7f6993db5)


### HTTP Analysis: 10.10.10.10:8080–10.10.10.70:1035

The HTTP traffic analysis identified a request for an index page followed by a 1x1 GIF image, typical of a web beacon used in tracking.
 

![image](https://github.com/anvithalolla/Threat-Detection-through-Packet-Inspection-and-Malware-Analysis/assets/55392153/5563bef8-6606-4bca-9545-67155444dad4)

![image](https://github.com/anvithalolla/Threat-Detection-through-Packet-Inspection-and-Malware-Analysis/assets/55392153/84111834-2d57-423e-9e96-7b80e8e47091)


### File Carving: 10.10.10.10:8080–10.10.10.70:1035

Carved files from the HTTP traffic showed an HTML page containing an exploit and a tiny GIF image, likely used for confirming the exploit delivery.

## Theory of the Case

The theory of the case postulates that Vick Timmes's computer was compromised via a spear phishing attack that leveraged a known Internet Explorer vulnerability. Once exploited, the attacker deployed malware that made persistent outbound attempts to a command-and-control server, culminating in the download of a suspicious executable, indicating a successful breach and potential control over Vick's system.

## Findings
The forensic investigation reveals a sophisticated attack leveraging a known exploit to deploy malware onto the internal computer of a high-value target.
